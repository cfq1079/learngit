{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/HASEE/Documents/HBuilderProjects/小程序/pages/seat/seat.vue?31d3","webpack:///C:/Users/HASEE/Documents/HBuilderProjects/小程序/pages/seat/seat.vue?1d29","webpack:///C:/Users/HASEE/Documents/HBuilderProjects/小程序/pages/seat/seat.vue?5312","webpack:///C:/Users/HASEE/Documents/HBuilderProjects/小程序/pages/seat/seat.vue?81fc","uni-app:///pages/seat/seat.vue","webpack:///C:/Users/HASEE/Documents/HBuilderProjects/小程序/pages/seat/seat.vue?6f31"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,0F;AACAA,UAAU,CAACC,aAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6H;AAC7H;AACwD;AACL;AACsC;;;AAGzF;AACgL;AAChL,gBAAgB,yLAAU;AAC1B,EAAE,0EAAM;AACR,EAAE,2FAAM;AACR,EAAE,oGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,+FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAqpB,CAAgB,0qBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC4EzqB;AACA,MADA,kBACA;AACA;AACA,iBADA,EACA;AACA,mBAFA,EAEA;AACA,gBAHA,EAGA;AACA,mBAJA,EAIA;AACA,gBALA,EAKA;AACA,gBANA,EAMA;AACA,iBAPA,EAOA;AACA,kBARA,EAQA;AACA,cATA,EASA;AACA,cAVA,EAUA;AACA,eAXA,EAWA;AACA,eAZA,EAYA;AACA,mBAbA,EAaA;AACA,kBAdA,EAcA;AACA,cAfA,EAeA;AACA,gBAhBA,EAgBA;AACA,oBAjBA;;AAmBA,GArBA;AAsBA;AACA,UADA,oBACA;AACA;AACA,KAHA;AAIA,UAJA,oBAIA;AACA;AACA,KANA;AAOA,SAPA,mBAOA;AACA;AACA,KATA,EAtBA;;AAiCA,QAjCA,oBAiCA;AACA;AACA;AACA;AACA;;;;AAIA,OANA;;AAQA;AACA,GA5CA;AA6CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CANA;AAOA,SAPA,aAOA;AACA;AACA;AACA;AACA;AACA,SAZA;AAaA;AACA;AACA;AACA;AACA;;AAEA;AACA,KArBA;AAsBA;AACA;AACA;AACA,kBADA;AAEA,sBAFA;AAGA,oBAHA;AAIA,uBAJA;;AAMA;AACA;AACA,oEADA;AAEA,0DAFA;AAGA;AACA,KAnCA;AAoCA;AACA;AACA;AACA;AACA;AACA,uBADA,CACA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA;AACA,sBADA;AAEA,sCAFA;AAGA,kCAHA;AAIA,wCAJA;;AAMA;AACA;AACA;AACA;AACA,mBADA;AAEA,cAFA,cAEA;AACA;AACA;AACA;AACA,WANA;AAOA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA;AACA;AACA,KAtEA;AAuEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAlFA;AAmFA;AACA;AACA;AACA;AACA,KAvFA;AAwFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAtGA;AAuGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KApHA;AAqHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAJA,MAIA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAxIA;AAyIA;AACA;AACA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAJA;AAKA;AACA;AACA;AACA,KAxJA;AAyJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAjLA;;AAmLA;AACA;AACA;;;;;;;;;;AAUA;;;;;;;;AAQA;;AAEA;AACA,kDADA;;AAGA;AACA;AACA;AACA,uCADA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BADA;AAEA,sCAFA;;AAIA;;AAEA;AACA;AACA;AACA;AACA,iCADA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SALA;AAMA,OARA,MAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SALA;AAMA;;AAEA;AACA;AACA,KA9PA;;AAgQA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA5QA;AA6QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KApRA;AAqRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA/RA,EA7CA,E;;;;;;;;;;;;;AC5EA;AAAA;AAAA;AAAA;AAA2tC,CAAgB,4rCAAG,EAAC,C","file":"pages/seat/seat.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/seat/seat.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./seat.vue?vue&type=template&id=651528b3&scoped=true&\"\nvar renderjs\nimport script from \"./seat.vue?vue&type=script&lang=js&\"\nexport * from \"./seat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./seat.vue?vue&type=style&index=0&id=651528b3&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"651528b3\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"C:/Users/HASEE/Documents/HBuilderProjects/小程序/pages/seat/seat.vue\"\nexport default component.exports","export * from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./seat.vue?vue&type=template&id=651528b3&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./seat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./seat.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"w-100\">\r\n\t\t<view class=\"bg-f1 h-100vh\">\r\n\t\t\t<view class=\"pt-f left-0 w-100 p-0-32 bg-white z1000\" :style=\"'height: 132rpx;top:0'\">\r\n\t\t\t\t<view>\r\n\t\t\t\t\t<view class=\"fz-34 fw-b pt-20\">\r\n\t\t\t\t\t\t三体2：黑暗森林\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"mt-10 fz-28 color-666\">\r\n\t\t\t\t\t\t2021年1月22日 国语3D\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<movable-area :style=\"'height:'+(seatRow*40+350)+'rpx;width: 100vw;top:'+(rpxNum*132)+'px'\" class=\"pt-f left-0\">\r\n\t\t\t\t<movable-view :style=\"'width: 100vw;height:'+(seatRow*40+350)+'rpx;'\" :inertia=\"true\" :scale=\"true\" :scale-min=\"0.95\"\r\n\t\t\t\t :scale-max=\"2\" direction=\"all\" @change=\"onMove\" @scale=\"onScale\">\r\n\t\t\t\t\t<view class=\"Stage dp-f jc-c ai-c fz-22 color-333\">\r\n\t\t\t\t\t\t5号厅\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view style=\"width: 100rpx;height: 30rpx;\" class=\"m-0-a mt-48 dp-f jc-c ai-c fz-20 color-999 b-1 br-5\">银幕中央</view>\r\n\t\t\t\t\t<view class=\"pt-f pa-v-2 b-d-1\" :style=\"'height:'+seatRow*(20+seatSize*pxNum)+'rpx;top:165rpx;width:0'\"></view>\r\n\t\t\t\t\t<view v-for=\"(item,index) in seatArray\" :key=\"index\" class=\"dp-f jc-c mt-20\" :style=\"'width:'+boxWidth+'px;height:'+seatSize+'px'\">\r\n\t\t\t\t\t\t<view v-for=\"(seat,col) in item\" :key=\"col\" class=\"dp-ib\" :style=\"'width:'+seatSize+'px;height:'+seatSize+'px'\"\r\n\t\t\t\t\t\t @click=\"handleChooseSeat(index,col)\">\r\n\t\t\t\t\t\t\t<image v-if=\"seat.type===0\" class=\"w-100 h-100\" src=\"../../static/unselected.png\" mode=\"aspectFit\"></image>\r\n\t\t\t\t\t\t\t<image v-else-if=\"seat.type===1\" class=\"w-100 h-100\" src=\"../../static/selected.png\" mode=\"aspectFit\"></image>\r\n\t\t\t\t\t\t\t<image v-else-if=\"seat.type===2\" class=\"w-100 h-100\" src=\"../../static/bought.png\" mode=\"aspectFit\"></image>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"pt-f bg-line br-15 over-h\" :style=\"'left: '+(10-moveX/scale)+'px;top:109rpx;width:30rpx;'\">\r\n\t\t\t\t\t\t<view class=\"w-100 dp-f ai-c jc-c fz-22 color-fff\" :style=\"'height:'+seatSize+'px;margin-top:20rpx;'\" v-for=\"(m,mindex) in mArr\"\r\n\t\t\t\t\t\t :key=\"mindex\">{{m}}</view>\r\n\t\t\t\t\t\t<view :style=\"'height: 20rpx;'\"></view>\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t</movable-view>\r\n\t\t\t</movable-area>\r\n\t\t\t<view class=\"pt-f bottom-bar left-0 dp-f fd-cr z1000\">\r\n\t\t\t\t<view class=\"bg-white p-all-32\">\r\n\t\t\t\t\t<view class=\"dp-f ai-c jc-c fz-28 color-333 mb-20\" v-if=\"SelectNum===0\">\r\n\t\t\t\t\t\t推荐选座\r\n\t\t\t\t\t\t<view style=\"width: 106rpx;height: 60rpx;\" class=\"b-1 br-5 dp-f ai-c jc-c fz-28 ml-20\" v-for=\"(n,numindex) in 4\"\r\n\t\t\t\t\t\t :key=\"n\" @click=\"smartChoose(numindex+1)\">\r\n\t\t\t\t\t\t\t{{numindex+1}}人\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"dp-f ai-c fw-w fz-28 color-333 mb-20\" v-if=\"SelectNum>0\">\r\n\t\t\t\t\t\t<text>已选</text>\r\n\t\t\t\t\t\t<view class=\"p-all-10 b-1 br-5 dp-f ai-c jc-c fz-28 ml-20\" v-for=\"(optItem,optindex) in optArr\" :key=\"optindex\">\r\n\t\t\t\t\t\t\t{{optItem.RowNum+'排'+optItem.ColumnNum+'座'}}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view style=\"width: 686rpx;height: 90rpx;\" class=\"dp-f jc-c ai-c br-10 fz-34 color-fff\" :class=\"SelectNum>0?'bg-red-1':'bg-unbtn'\"\r\n\t\t\t\t\t @click=\"buySeat\">\r\n\t\t\t\t\t\t{{SelectNum>0?('￥ '+aPrice+' 确认座位'):'请选座位'}}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"dp-f jc-c ai-c mb-20 fz-28\" v-if=\"showTis\">\r\n\t\t\t\t\t<view class=\"dp-f jc-c ai-c m-0-10\">\r\n\t\t\t\t\t\t<image :style=\"'width:'+seatSize+'px;height:'+seatSize+'px'\" src=\"/static/unselected.png\" mode=\"aspectFit\"></image><span\r\n\t\t\t\t\t\t class=\"ml-10\">可选</span>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"dp-f jc-c ai-c m-0-10\">\r\n\t\t\t\t\t\t<image :style=\"'width:'+seatSize+'px;height:'+seatSize+'px'\" src=\"/static/bought.png\" mode=\"aspectFit\"></image><span\r\n\t\t\t\t\t\t class=\"ml-10\">不可选</span>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"dp-f jc-c ai-c m-0-10\">\r\n\t\t\t\t\t\t<image :style=\"'width:'+seatSize+'px;height:'+seatSize+'px'\" src=\"/static/selected.png\" mode=\"aspectFit\"></image><span\r\n\t\t\t\t\t\t class=\"ml-10\">选中</span>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n<script>\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tscaleMin:1,//h5端为解决1无法缩小问题，设为0.95\r\n\t\t\t\tboxWidth: 400, //屏幕宽度px\r\n\t\t\t\tspace: ' ', //空格\r\n\t\t\t\tseatArray: [], //影院座位的二维数组,-1为非座位，0为未购座位，1为已选座位(绿色),2为已购座位(红色),一维行，二维列\r\n\t\t\t\tseatRow: 0, //影院座位行数\r\n\t\t\t\tseatCol: 0, //影院座位列数\r\n\t\t\t\tseatSize: 0, //座位尺寸\r\n\t\t\t\tSelectNum: 0, //选择座位数\r\n\t\t\t\tmoveX: 0, //水平移动偏移量\r\n\t\t\t\tscale: 1, //放大倍数\r\n\t\t\t\tminRow: 0, //从第几行开始排座位\r\n\t\t\t\tminCol: 0, //从第几列开始排座位\r\n\t\t\t\tshowTis: true, //显示选座提示\r\n\t\t\t\tseatList: [], //接口获取的原始位置\r\n\t\t\t\tmArr: [], //排数提示\r\n\t\t\t\toptArr: [], //选中的座位数组。\r\n\t\t\t\tisWXAPP:false,\r\n\t\t\t};\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\taPrice() {\r\n\t\t\t\treturn this.SelectNum * 36\r\n\t\t\t},\r\n\t\t\trpxNum() {\r\n\t\t\t\treturn this.boxWidth / 750\r\n\t\t\t},\r\n\t\t\tpxNum() {\r\n\t\t\t\treturn 750 / this.boxWidth\r\n\t\t\t},\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\t//获取宽度\r\n\t\t\tuni.getSystemInfo({\r\n\t\t\t\tsuccess: function(e) {\r\n\t\t\t\t\tthis.boxWidth = e.screenWidth\r\n\t\t\t\t\t//#ifdef H5\r\n\t\t\t\t\tthis.scaleMin = 0.95\r\n\t\t\t\t\t//#endif\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tthis.initData()\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tinitData: function() {\r\n\t\t\t\tlet arr = seatData\r\n\t\t\t\t//假数据说明：SeatCode座位编号，RowNum-行号，ColumnNum-纵号，YCoord-Y坐标，XCoord-X坐标，Status-状态\r\n\t\t\t\tlet row = 0\r\n\t\t\t\tlet col = 0\r\n\t\t\t\tlet minCol = parseInt(arr[0].XCoord)\r\n\t\t\t\tlet minRow = parseInt(arr[0].YCoord)\r\n\t\t\t\tfor (let i of arr) {\r\n\t\t\t\t\tminRow = parseInt(i.YCoord) < minRow ? parseInt(i.YCoord) : minRow\r\n\t\t\t\t\tminCol = parseInt(i.XCoord) < minCol ? parseInt(i.XCoord) : minCol\r\n\t\t\t\t\trow = parseInt(i.YCoord) > row ? parseInt(i.YCoord) : row\r\n\t\t\t\t\tcol = parseInt(i.XCoord) > col ? parseInt(i.XCoord) : col\r\n\t\t\t\t}\r\n\t\t\t\tthis.seatList = arr\r\n\t\t\t\tthis.seatRow = row - minRow + 1\r\n\t\t\t\tthis.seatCol = col - minCol + 3\r\n\t\t\t\tthis.minRow = minRow\r\n\t\t\t\tthis.minCol = minCol - 1\r\n\r\n\t\t\t\tthis.initSeatArray()\r\n\t\t\t},\r\n\t\t\t//初始座位数组\r\n\t\t\tinitSeatArray: function() {\r\n\t\t\t\tlet seatArray = Array(this.seatRow).fill(0).map(() => Array(this.seatCol).fill({\r\n\t\t\t\t\ttype: -1,\r\n\t\t\t\t\tSeatCode: '',\r\n\t\t\t\t\tRowNum: '',\r\n\t\t\t\t\tColumnNum: ''\r\n\t\t\t\t}));\r\n\t\t\t\tthis.seatArray = seatArray\r\n\t\t\t\tthis.seatSize = this.boxWidth > 0 ?\r\n\t\t\t\t\tparseInt(parseInt(this.boxWidth, 10) / (this.seatCol + 1), 10) :\r\n\t\t\t\t\tparseInt(parseInt(414, 10) / (this.seatCol + 1), 10)\r\n\t\t\t\tthis.initNonSeatPlace();\r\n\t\t\t},\r\n\t\t\t//初始化是座位的地方\r\n\t\t\tinitNonSeatPlace: function() {\r\n\t\t\t\tlet seat = this.seatList.slice()\r\n\t\t\t\tlet arr = this.seatArray.slice()\r\n\t\t\t\tfor (let num in seat) {\r\n\t\t\t\t\tlet status = 2 //-1为非座位，0为未购座位，1为已选座位(绿色),2为已购座位(红色)\r\n\t\t\t\t\tif (seat[num].Status === 0) {\r\n\t\t\t\t\t\tstatus = 0\r\n\t\t\t\t\t} else if (seat[num].Status === -1) {\r\n\t\t\t\t\t\tstatus = -1\r\n\t\t\t\t\t}\r\n\t\t\t\t\tarr[parseInt(seat[num].YCoord) - this.minRow][parseInt(seat[num].XCoord) - this.minCol] = {\r\n\t\t\t\t\t\ttype: status,\r\n\t\t\t\t\t\tSeatCode: seat[num].SeatCode,\r\n\t\t\t\t\t\tRowNum: seat[num].RowNum,\r\n\t\t\t\t\t\tColumnNum: seat[num].ColumnNum\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.seatArray = arr.slice()\r\n\t\t\t\tlet mArr = []\r\n\t\t\t\tfor (let i in arr) {\r\n\t\t\t\t\tlet m = ''\r\n\t\t\t\t\tfor (let n of arr[i]) {\r\n\t\t\t\t\t\tif (n.SeatCode) {\r\n\t\t\t\t\t\t\tm = n.RowNum\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (m) {\r\n\t\t\t\t\t\tmArr.push(m)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmArr.push('')\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.mArr = mArr\r\n\t\t\t},\r\n\t\t\t//放大缩小事件\r\n\t\t\tonScale: function(e) {\r\n\t\t\t\tthis.showTis = false\r\n\t\t\t\t// this.moveX=-e.detail.x\r\n\t\t\t\tlet w = this.boxWidth * 0.5\r\n\t\t\t\tlet s = 1 - e.detail.scale\r\n\t\t\t\tthis.moveX = w * s\r\n\t\t\t\tthis.scale = e.detail.scale\r\n\t\t\t\tif (s > 0 || s === 0) {\r\n\t\t\t\t\tthis.showTis = true\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//移动事件\r\n\t\t\tonMove: function(e) {\r\n\t\t\t\tthis.showTis = false\r\n\t\t\t\tthis.moveX = e.detail.x\r\n\t\t\t},\r\n\t\t\t//重置座位\r\n\t\t\tresetSeat: function() {\r\n\t\t\t\tthis.SelectNum = 0\r\n\t\t\t\tthis.optArr = []\r\n\t\t\t\t//将所有已选座位的值变为0\r\n\t\t\t\tlet oldArray = this.seatArray.slice();\r\n\t\t\t\tfor (let i = 0; i < this.seatRow; i++) {\r\n\t\t\t\t\tfor (let j = 0; j < this.seatCol; j++) {\r\n\t\t\t\t\t\tif (oldArray[i][j].type === 1) {\r\n\t\t\t\t\t\t\toldArray[i][j].type = 0\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.seatArray = oldArray;\r\n\t\t\t},\r\n\t\t\t//选定且购买座位\r\n\t\t\tbuySeat: function() {\r\n\t\t\t\tif (this.SelectNum === 0) {\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tlet oldArray = [];\r\n\t\t\t\tfor (let i = 0; i < this.seatRow; i++) {\r\n\t\t\t\t\tfor (let j = 0; j < this.seatCol; j++) {\r\n\t\t\t\t\t\tif (this.seatArray[i][j].type === 1) {\r\n\t\t\t\t\t\t\toldArray.push(this.seatArray[i][j].SeatCode)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//处理座位选择逻辑\r\n\t\t\thandleChooseSeat: function(row, col) {\r\n\t\t\t\tlet seatValue = this.seatArray[row][col].type;\r\n\t\t\t\tlet newArray = this.seatArray;\r\n\t\t\t\t//如果是已购座位，直接返回\r\n\t\t\t\tif (seatValue === 2 || seatValue === -1) return\r\n\t\t\t\t//如果是已选座位点击后变未选\r\n\t\t\t\tif (seatValue === 1) {\r\n\t\t\t\t\tnewArray[row][col].type = 0\r\n\t\t\t\t\tthis.SelectNum--\r\n\t\t\t\t\tthis.getOptArr(newArray[row][col], 0)\r\n\t\t\t\t} else if (seatValue === 0) {\r\n\t\t\t\t\tnewArray[row][col].type = 1\r\n\t\t\t\t\tthis.SelectNum++\r\n\t\t\t\t\tthis.getOptArr(newArray[row][col], 1)\r\n\t\t\t\t}\r\n\t\t\t\t//必须整体更新二维数组，Vue无法检测到数组某一项更新,必须slice复制一个数组才行\r\n\t\t\t\tthis.seatArray = newArray.slice();\r\n\t\t\t\r\n\t\t\t},\r\n\t\t\t//处理已选座位数组\r\n\t\t\tgetOptArr: function(item, type) {\r\n\t\t\t\tlet optArr = this.optArr\r\n\t\t\t\tif (type === 1) {\r\n\t\t\t\t\toptArr.push(item)\r\n\t\t\t\t} else if (type === 0) {\r\n\t\t\t\t\tlet arr = []\r\n\t\t\t\t\toptArr.forEach(v => {\r\n\t\t\t\t\t\tif (v.SeatCode !== item.SeatCode) {\r\n\t\t\t\t\t\t\tarr.push(v)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\toptArr = arr\r\n\t\t\t\t}\r\n\t\t\t\tthis.optArr = optArr.slice()\r\n\t\t\t},\r\n\t\t\t//推荐选座,参数是推荐座位数目，\r\n\t\t\tsmartChoose: function(num) {\r\n\t\t\t\tconsole.log('num===', num)\r\n\t\t\t\t// 先重置\r\n\t\t\t\tthis.resetSeat()\r\n\t\t\t\t//找到影院座位水平垂直中间位置的后一排\r\n\t\t\t\tlet rowStart = parseInt((this.seatRow - 1) / 2, 10) + 1;\r\n\t\t\t\t//先从中间排往后排搜索\r\n\t\t\t\tlet backResult = this.searchSeatByDirection(rowStart, this.seatRow - 1, num);\r\n\t\t\t\tif (backResult.length > 0) {\r\n\t\t\t\t\tthis.chooseSeat(backResult);\r\n\t\t\t\t\tthis.SelectNum += num\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t//再从中间排往前排搜索\r\n\t\t\t\tlet forwardResult = this.searchSeatByDirection(rowStart - 1, 0, num);\r\n\t\t\t\tif (forwardResult.length > 0) {\r\n\t\t\t\t\tthis.chooseSeat(forwardResult);\r\n\t\t\t\t\tthis.SelectNum += num\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t//提示用户无合法位置可选\r\n\t\t\t\talert('无合法位置可选!')\r\n\t\t\t\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t//搜索函数,参数:fromRow起始行，toRow终止行,num推荐座位数\r\n\t\t\tsearchSeatByDirection: function(fromRow, toRow, num) {\r\n\t\t\t\t/*\r\n\t\t\t\t * 推荐座位规则\r\n\t\t\t\t * (1)初始状态从座位行数的一半处的后一排的中间开始向左右分别搜索，取离中间最近的，如果满足条件，\r\n\t\t\t\t *    记录下该结果离座位中轴线的距离，后排搜索完成后取距离最小的那个结果座位最终结果，优先向后排进行搜索，\r\n\t\t\t\t *    后排都没有才往前排搜，前排逻辑同上\r\n\t\t\t\t *\r\n\t\t\t\t * (2)只考虑并排且连续的座位，不能不在一排或者一排中间有分隔\r\n\t\t\t\t *\r\n\t\t\t\t * */\r\n\r\n\t\t\t\t/*\r\n\t\t\t\t * 保存当前方向搜索结果的数组,元素是对象,result是结果数组，offset代表与中轴线的偏移距离\r\n\t\t\t\t * {\r\n\t\t\t\t *   result:Array([x,y])\r\n\t\t\t\t *   offset:Number\r\n\t\t\t\t * }\r\n\t\t\t\t *\r\n\t\t\t\t */\r\n\t\t\t\tlet currentDirectionSearchResult = [];\r\n\r\n\t\t\t\tlet largeRow = fromRow > toRow ? fromRow : toRow,\r\n\t\t\t\t\tsmallRow = fromRow > toRow ? toRow : fromRow;\r\n\r\n\t\t\t\tfor (let i = smallRow; i <= largeRow; i++) {\r\n\t\t\t\t\t//每一排的搜索,找出该排里中轴线最近的一组座位\r\n\t\t\t\t\tlet tempRowResult = [],\r\n\t\t\t\t\t\tminDistanceToMidLine = Infinity;\r\n\t\t\t\t\tfor (let j = 0; j <= this.seatCol - num; j++) {\r\n\t\t\t\t\t\t//如果有合法位置\r\n\t\t\t\t\t\tif (this.checkRowSeatContinusAndEmpty(i, j, j + num - 1)) {\r\n\t\t\t\t\t\t\t//计算该组位置距离中轴线的距离:该组位置的中间位置到中轴线的距离\r\n\t\t\t\t\t\t\tlet resultMidPos = parseInt((j + num / 2), 10);\r\n\t\t\t\t\t\t\tlet distance = Math.abs(parseInt(this.seatCol / 2) - resultMidPos);\r\n\t\t\t\t\t\t\t//如果距离较短则更新\r\n\t\t\t\t\t\t\tif (distance < minDistanceToMidLine) {\r\n\t\t\t\t\t\t\t\tminDistanceToMidLine = distance;\r\n\t\t\t\t\t\t\t\t//该行的最终结果\r\n\t\t\t\t\t\t\t\ttempRowResult = this.generateRowResult(i, j, j + num - 1)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//保存该行的最终结果\r\n\t\t\t\t\tcurrentDirectionSearchResult.push({\r\n\t\t\t\t\t\tresult: tempRowResult,\r\n\t\t\t\t\t\toffset: minDistanceToMidLine\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//处理后排的搜索结果:找到距离中轴线最短的一个\r\n\t\t\t\t//注意这里的逻辑需要区分前后排，对于后排是从前往后，前排则是从后往前找\r\n\t\t\t\tlet isBackDir = fromRow < toRow;\r\n\t\t\t\tlet finalReuslt = [],\r\n\t\t\t\t\tminDistanceToMid = Infinity;\r\n\t\t\t\tif (isBackDir) {\r\n\t\t\t\t\t//后排情况,从前往后\r\n\t\t\t\t\tcurrentDirectionSearchResult.forEach((item) => {\r\n\t\t\t\t\t\tif (item.offset < minDistanceToMid) {\r\n\t\t\t\t\t\t\tfinalReuslt = item.result;\r\n\t\t\t\t\t\t\tminDistanceToMid = item.offset;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//前排情况，从后往前找\r\n\t\t\t\t\tcurrentDirectionSearchResult.reverse().forEach((item) => {\r\n\t\t\t\t\t\tif (item.offset < minDistanceToMid) {\r\n\t\t\t\t\t\t\tfinalReuslt = item.result;\r\n\t\t\t\t\t\t\tminDistanceToMid = item.offset;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//直接返回结果\r\n\t\t\t\treturn finalReuslt\r\n\t\t\t},\r\n\r\n\t\t\t/*辅助函数，判断每一行座位从i列到j列是否全部空余且连续\r\n\t\t\t *\r\n\t\t\t */\r\n\t\t\tcheckRowSeatContinusAndEmpty: function(rowNum, startPos, endPos) {\r\n\t\t\t\tlet isValid = true;\r\n\t\t\t\tfor (let i = startPos; i <= endPos; i++) {\r\n\t\t\t\t\tif (this.seatArray[rowNum][i].type !== 0) {\r\n\t\t\t\t\t\tisValid = false;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn isValid\r\n\t\t\t},\r\n\t\t\t//辅助函数：返回每一行的某个合理位置的座位数组\r\n\t\t\tgenerateRowResult: function(row, startPos, endPos) {\r\n\t\t\t\tlet result = [];\r\n\t\t\t\tfor (let i = startPos; i <= endPos; i++) {\r\n\t\t\t\t\tresult.push([row, i])\r\n\t\t\t\t}\r\n\t\t\t\treturn result\r\n\t\t\t},\r\n\t\t\t//辅助函数:智能推荐的选座操作\r\n\t\t\tchooseSeat: function(result) {\r\n\t\t\t\tlet opt = this.optArr\r\n\t\t\t\tlet oldArray = this.seatArray.slice();\r\n\t\t\t\tfor (let i = 0; i < result.length; i++) {\r\n\t\t\t\t\t//选定座位\r\n\t\t\t\t\toldArray[result[i][0]][result[i][1]].type = 1\r\n\t\t\t\t\tthis.optArr.push(oldArray[result[i][0]][result[i][1]])\r\n\t\t\t\t}\r\n\t\t\t\tthis.seatArray = oldArray;\r\n\t\t\t},\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.p-all-10{\r\n\t\tpadding: 10rpx;\r\n\t}\r\n\t.ml-10 {\r\n\t\tmargin-left: 10rpx;\r\n\t}\r\n\r\n\t.m-0-10 {\r\n\t\tmargin: 0 10rpx;\r\n\t}\r\n\r\n\t.bg-unbtn {\r\n\t\tbackground-color: #f9abb3;\r\n\t}\r\n\r\n\t.bg-red-1 {\r\n\t\tbackground-color: #F45664;\r\n\t}\r\n\r\n\t.br-10 {\r\n\t\tborder-radius: 10rpx;\r\n\t}\r\n\r\n\t.ml-20 {\r\n\t\tmargin-left: 20rpx;\r\n\t}\r\n\r\n\t.mb-20 {\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\r\n\t.p-all-32 {\r\n\t\tpadding: 32rpx;\r\n\t}\r\n\r\n\t.fd-cr {\r\n\t\tflex-direction: column-reverse;\r\n\t\t/* 主轴方向从下到上,默认从左到右 */\r\n\t}\r\n\r\n\t.bottom-bar {\r\n\t\tbottom: var(--window-bottom);\r\n\t}\r\n\r\n\t.color-fff {\r\n\t\tcolor: #fff\r\n\t}\r\n\r\n\t.br-15 {\r\n\t\tborder-radius: 15rpx;\r\n\t}\r\n\r\n\t.over-h {\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.dp-ib {\r\n\t\tdisplay: inline-block;\r\n\t}\r\n\r\n\t.mt-20 {\r\n\t\tmargin-top: 20rpx;\r\n\t}\r\n\r\n\t.pa-v-2 {\r\n\t\t/* 定位垂直对齐 */\r\n\t\tleft: 50%;\r\n\t\ttransform: translateX(-50%)\r\n\t}\r\n\r\n\t.b-d-1 {\r\n\t\tborder: 1px dashed #e5e5e5;\r\n\t}\r\n\r\n\t.w-100 {\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.h-100 {\r\n\t\theight: 100%;\r\n\t}\r\n\r\n\t.bg-f1 {\r\n\t\tbackground-color: #f1f1f1;\r\n\t}\r\n\r\n\t.h-100vh {\r\n\t\theight: 100vh;\r\n\t}\r\n\r\n\t.pt-f {\r\n\t\tposition: fixed;\r\n\t}\r\n\r\n\t.left-0 {\r\n\t\tleft: 0;\r\n\t}\r\n\r\n\t.p-0-32 {\r\n\t\tpadding: 0 32rpx;\r\n\t}\r\n\r\n\t.pt-20 {\r\n\t\tpadding-top: 20rpx;\r\n\t}\r\n\r\n\t.bg-white {\r\n\t\tbackground-color: #fff;\r\n\t}\r\n\r\n\t.z1000 {\r\n\t\tz-index: 1000;\r\n\t}\r\n\r\n\t.fz-34 {\r\n\t\tfont-size: 34rpx;\r\n\t}\r\n\r\n\t.fw-b {\r\n\t\tfont-weight: bold;\r\n\t}\r\n\r\n\t.mt-10 {\r\n\t\tmargin-top: 10rpx;\r\n\t}\r\n\r\n\t.fz-28 {\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n\r\n\t.color-666 {\r\n\t\tcolor: #666666\r\n\t}\r\n\r\n\t.dp-f {\r\n\t\tdisplay: flex;\r\n\t}\r\n\r\n\t.jc-c {\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.ai-c {\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.fz-22 {\r\n\t\tfont-size: 22rpx;\r\n\t}\r\n\r\n\t.color-333 {\r\n\t\tcolor: #333333\r\n\t}\r\n\r\n\t.m-0-a {\r\n\t\tmargin: 0 auto;\r\n\t}\r\n\r\n\t.mt-48 {\r\n\t\tmargin-top: 48rpx;\r\n\t}\r\n\r\n\t.fz-20 {\r\n\t\tfont-size: 20rpx;\r\n\t}\r\n\r\n\t.color-999 {\r\n\t\tcolor: #999999\r\n\t}\r\n\r\n\t.b-1 {\r\n\t\tborder: 1px solid #CCCCCC;\r\n\t}\r\n\r\n\t.br-5 {\r\n\t\tborder-radius: 5rpx;\r\n\t}\r\n\r\n\t.Stage {\r\n\t\tbackground-color: #dddddd;\r\n\t\twidth: 380rpx;\r\n\t\theight: 34rpx;\r\n\t\ttransform: perspective(34rpx) rotateX(-10deg);\r\n\t\tmargin: 0 auto;\r\n\t}\r\n\r\n\t.bg-line {\r\n\t\tbackground-color: rgba(0, 0, 0, 0.3);\r\n\t}\r\n\r\n\t.sel-seat {\r\n\t\tbackground: url('/static/selected.png') center center no-repeat;\r\n\t\tbackground-size: 100% 100%;\r\n\t}\r\n\t\r\n\t.unsel-seat {\r\n\t\tbackground: url('/static/unselected.png') center center no-repeat;\r\n\t\tbackground-size: 100% 100%;\r\n\t}\r\n\t\r\n\t.bought-seat {\r\n\t\tbackground: url('/static/bought.png') center center no-repeat;\r\n\t\tbackground-size: 100% 100%;\r\n\t}\r\n</style>\n","import mod from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./seat.vue?vue&type=style&index=0&id=651528b3&lang=scss&scoped=true&\"; export default mod; export * from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./seat.vue?vue&type=style&index=0&id=651528b3&lang=scss&scoped=true&\""],"sourceRoot":""}